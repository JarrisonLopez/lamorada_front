<section class="auth">
  <div class="shell">
    <header class="hero">
      <div class="brand">
        <img
          class="brand-logo-img"
          src="assets/lamorada-logo.png"
          alt="LaMorada"
          width="36"
          height="36"
          decoding="async"
        />
        <div class="brand-name">La<span class="accent">Morada</span></div>
      </div>
      <h2>Crear cuenta</h2>
      <p>Un registro rÃ¡pido para entrar a tu espacio de bienestar ğŸ’œ</p>
    </header>

    <div class="card" role="region" aria-labelledby="signup-title">
      <form [formGroup]="form" (ngSubmit)="submit()" class="form" autocomplete="off" novalidate>
        <!-- SecciÃ³n 1 -->
        <div class="section">
          <div class="legend">
            <span class="dot"></span> <span id="signup-title">IdentificaciÃ³n</span>
          </div>
          <div class="grid-2">
            <div class="field">
              <label class="label">Tipo de documento</label>
              <div class="input-wrap">
                <span class="ico">ğŸªª</span>
                <select
                  formControlName="document_type"
                  [class.invalid]="f['document_type'].touched && f['document_type'].invalid"
                  required
                >
                  <option value="" disabled selected>Seleccionaâ€¦</option>
                  <option *ngFor="let t of documentTypes" [value]="t.value">{{ t.label }}</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label class="label">NÃºmero de documento</label>
              <div class="input-wrap">
                <span class="ico">#</span>
                <input
                  formControlName="_id"
                  placeholder="Ej: 123456789"
                  [class.invalid]="f['_id'].touched && f['_id'].invalid"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- SecciÃ³n 2 -->
        <div class="section">
          <div class="legend"><span class="dot"></span> <span>Datos personales</span></div>

          <div class="field">
            <label class="label">Nombre(s)</label>
            <div class="input-wrap">
              <span class="ico">ğŸ‘¤</span>
              <input
                formControlName="name"
                placeholder="Tu nombre"
                [class.invalid]="f['name'].touched && f['name'].invalid"
              />
            </div>
          </div>

          <div class="grid-2">
            <div class="field">
              <label class="label">Primer apellido</label>
              <div class="input-wrap">
                <span class="ico">ğŸ‘¤</span>
                <input
                  formControlName="last_name1"
                  placeholder="Primer apellido"
                  [class.invalid]="f['last_name1'].touched && f['last_name1'].invalid"
                />
              </div>
            </div>
            <div class="field">
              <label class="label">Segundo apellido</label>
              <div class="input-wrap">
                <span class="ico">ğŸ‘¤</span>
                <input
                  formControlName="last_name2"
                  placeholder="Segundo apellido"
                  [class.invalid]="f['last_name2'].touched && f['last_name2'].invalid"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- SecciÃ³n 3 -->
        <div class="section">
          <div class="legend"><span class="dot"></span> <span>Contacto</span></div>

          <div class="grid-2">
            <div class="field">
              <label class="label">Edad</label>
              <div class="input-wrap">
                <span class="ico">ğŸ‚</span>
                <input
                  type="number"
                  min="1"
                  max="120"
                  formControlName="age"
                  placeholder="Ej: 28"
                  [class.invalid]="f['age'].touched && f['age'].invalid"
                />
              </div>
            </div>

            <div class="field">
              <label class="label">TelÃ©fono</label>
              <div class="input-wrap">
                <span class="ico">ğŸ“</span>
                <input
                  formControlName="phone"
                  inputmode="tel"
                  placeholder="Ej: 3001234567"
                  [class.invalid]="f['phone'].touched && f['phone'].invalid"
                />
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">Email</label>
            <div class="input-wrap">
              <span class="ico">âœ‰ï¸</span>
              <input
                type="email"
                autocomplete="email"
                inputmode="email"
                formControlName="email"
                placeholder="tucorreo@ejemplo.com"
                [class.invalid]="f['email'].touched && f['email'].invalid"
              />
            </div>
          </div>
        </div>

        <!-- SecciÃ³n 4 -->
        <div class="section">
          <div class="legend"><span class="dot"></span> <span>Seguridad</span></div>

          <div class="field">
            <label class="label">ContraseÃ±a</label>
            <div class="input-wrap">
              <span class="ico">ğŸ”’</span>
              <input
                [type]="pwVisible ? 'text' : 'password'"
                placeholder="MÃ­n. 8, 1 mayÃºscula, 1 nÃºmero y 1 sÃ­mbolo de @$!%*?&"
                formControlName="password"
                [class.invalid]="f['password'].touched && f['password'].invalid"
                autocomplete="new-password"
              />
              <button
                type="button"
                class="pw-toggle"
                (click)="togglePw()"
                [attr.aria-pressed]="pwVisible"
              >
                <span *ngIf="!pwVisible" aria-hidden="true">ğŸ‘ï¸</span>
                <span *ngIf="pwVisible" aria-hidden="true">ğŸ™ˆ</span>
              </button>
            </div>

            <div class="strength" *ngIf="f['password'].value">
              <div class="strength-bar"><span [style.width.%]="passwordStrength.score"></span></div>
              <span class="strength-badge">{{ passwordStrength.label }}</span>
            </div>
          </div>

          <div class="field">
            <label class="label">Confirmar contraseÃ±a</label>
            <div class="input-wrap">
              <span class="ico">âœ…</span>
              <input
                [type]="cpwVisible ? 'text' : 'password'"
                placeholder="Repite tu contraseÃ±a"
                formControlName="confirmPassword"
                [class.invalid]="
                  form.hasError('passwordsMismatch') && (confirm.touched || confirm.dirty)
                "
                autocomplete="new-password"
              />
              <button
                type="button"
                class="pw-toggle"
                (click)="toggleCpw()"
                [attr.aria-pressed]="cpwVisible"
              >
                <span *ngIf="!cpwVisible" aria-hidden="true">ğŸ‘ï¸</span>
                <span *ngIf="cpwVisible" aria-hidden="true">ğŸ™ˆ</span>
              </button>
            </div>
          </div>
        </div>

        <div class="actions">
          <button [disabled]="loading || form.invalid" aria-busy="{{ loading }}">
            <span *ngIf="loading" class="spinner" aria-hidden="true"></span>
            <span *ngIf="!loading">Registrarme</span>
            <span *ngIf="loading">Creando cuentaâ€¦</span>
          </button>
        </div>

        <div class="banner ok" *ngIf="msg" aria-live="polite">{{ msg }}</div>
        <div class="banner err" *ngIf="error" aria-live="assertive">{{ error }}</div>
      </form>
    </div>
  </div>
</section>
