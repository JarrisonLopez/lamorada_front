<div class="page">
  <!-- Toolbar de bÃºsqueda -->
  <div class="toolbar">
    <form class="search" (ngSubmit)="search()">
      <span class="ico">ðŸ”Ž</span>
      <input [(ngModel)]="q" name="q" placeholder="Buscar por tÃ­tuloâ€¦" />
      <button class="btn" type="submit">Buscar</button>
    </form>
  </div>

  <!-- Banners -->
  <div *ngIf="msg" class="banner ok" aria-live="polite">{{ msg }}</div>
  <div *ngIf="err" class="banner err" aria-live="assertive">{{ err }}</div>

  <!-- Loading skeleton -->
  <div class="grid" *ngIf="loading">
    <div class="skel" *ngFor="let i of [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]">
      <div class="img"></div>
      <div class="line" style="width: 90%"></div>
      <div class="line" style="width: 60%"></div>
      <div class="line" style="width: 40%"></div>
      <div class="line" style="width: 100%; height: 36px; border-radius: 10px"></div>
    </div>
  </div>

  <!-- Lista -->
  <div class="grid" *ngIf="!loading && products?.length">
    <div class="card" *ngFor="let p of products">
      <div class="cover">
        <img *ngIf="p.cover_url" [src]="p.cover_url" alt="Portada de {{ p.title }}" />
      </div>

      <h3>{{ p.title }}</h3>
      <div class="meta">{{ p.author }} â€” {{ p.publish_year }}</div>
      <div class="price">{{ p.price | currency : 'USD' : 'symbol' }}</div>

      <button [disabled]="addingId === p._id" (click)="addToCart(p)">
        {{ addingId === p._id ? 'Agregandoâ€¦' : 'Agregar' }}
      </button>
    </div>
  </div>

  <!-- VacÃ­o -->
  <div class="empty" *ngIf="!loading && !products?.length">
    No encontramos productos para tu bÃºsqueda.
  </div>
</div>
