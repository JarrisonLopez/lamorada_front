<div class="page">
  <header class="hero card">
    <div>
      <h2>Disponibilidad</h2>
      <div class="muted">Selecciona días (en semana) y define el/los intervalos.</div>
    </div>
  </header>

  <section class="card">
    <div class="body">
      <div *ngIf="loading">Cargando…</div>
      <p *ngIf="err" class="msg err">{{ err }}</p>
      <p *ngIf="msg" class="msg ok">{{ msg }}</p>

      <form [formGroup]="form" *ngIf="!loading">
        <!-- DÍAS -->
        <h3>Días disponibles</h3>
        <div class="chips">
          <label *ngFor="let d of days">
            <input
              type="checkbox"
              [checked]="(form.value.days || []).includes(d.key)"
              (change)="toggleDay(d.key, $any($event.target).checked)"
            />
            {{ d.label }}
          </label>
        </div>

        <!-- SLOTS -->
        <h3 style="margin-top:12px">Horarios (intervalos)</h3>
        <div class="slots">
          <div *ngFor="let g of slotsFA.controls; let i = index; trackBy: trackIdx" [formGroup]="slotAt(i)" class="slot">
            <label>Inicio <input type="time" formControlName="start" /></label>
            <label>Fin <input type="time" formControlName="end" /></label>
            <button type="button" class="btn ghost" (click)="removeSlot(i)" [disabled]="slotsFA.length<=1">Eliminar</button>
          </div>
        </div>

        <div class="actions">
          <button type="button" class="btn ghost" (click)="addSlot()">Añadir intervalo</button>
          <div class="spacer"></div>
          <button type="button" class="btn danger" *ngIf="docId" (click)="delete()">Eliminar</button>
          <button type="button" class="btn primary" (click)="save()">Guardar</button>
        </div>
      </form>
    </div>
  </section>
</div>
